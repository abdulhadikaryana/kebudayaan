$(window).load(function(){lamanbudaya.maps.createMap();$("#submittext").click(function(a){a.preventDefault();if(lamanbudaya.maps.validateTextForm()){$.blockUI({message:$("#ajax-message")});lamanbudaya.maps.reset();lamanbudaya.maps.clearAreaForm();lamanbudaya.maps.clearCategoryForm();var b=$("#searchname").val();lamanbudaya.maps.getCultureByName(b)}});$("#submitarea").click(function(b){b.preventDefault();if(lamanbudaya.maps.validateAreaForm()){$.blockUI({message:$("#ajax-message")});lamanbudaya.maps.reset();lamanbudaya.maps.clearTextForm();lamanbudaya.maps.clearCategoryForm();var a=lamanbudaya.maps.getSelectedArea();lamanbudaya.maps.getCultureByArea(a)}});$("#submitcategory").click(function(b){b.preventDefault();if(lamanbudaya.maps.validateCategoryForm()){$.blockUI({message:$("#ajax-message")});lamanbudaya.maps.reset();lamanbudaya.maps.clearAreaForm();lamanbudaya.maps.clearTextForm();var a=lamanbudaya.maps.getSelectedCategory();lamanbudaya.maps.getCultureByCategory(a)}});$("#island").change(function(){lamanbudaya.maps.onIslandChange()})});lamanbudaya.maps={map:null,currentInfoWindow:null,currentMarker:null,markersArray:[],indonesiaLatLng:new google.maps.LatLng(-2,118),iconStandard:lamanbudaya.url.imageUrl+"/map/poi_small.png",iconSpecial:lamanbudaya.url.imageUrl+"/map/poi_small2.png",createMap:function(){var a={zoom:4,center:lamanbudaya.maps.indonesiaLatLng,mapTypeId:google.maps.MapTypeId.ROADMAP};lamanbudaya.maps.map=new google.maps.Map(document.getElementById("map-content"),a);lamanbudaya.maps.createFullMapControl()},getCultureByName:function(a){lamanbudaya.maps.reset();$.ajax({type:"POST",url:lamanbudaya.url.baseUrl+"/ajax/destination-by-name",data:{name:a},dataType:"json",success:function(b){lamanbudaya.maps.createMarkersAndList(b,'for "'+a+'"')}})},getCultureByArea:function(a){$.ajax({type:"POST",url:lamanbudaya.url.baseUrl+"/ajax/destination-by-area",data:{areaId:a[0]},dataType:"json",success:function(b){lamanbudaya.maps.createMarkersAndList(b,"in "+a[1]);delete a}})},getCultureByCategory:function(a){$.ajax({type:"POST",url:lamanbudaya.url.baseUrl+"/ajax/destination-by-category",data:{categoryId:a[0]},dataType:"json",success:function(b){lamanbudaya.maps.createMarkersAndList(b,"in "+a[1]);delete a}})},getSelectedArea:function(){var c=$("#island").val();var a=$("#province").val();if(a!=""){var b=$("#province option:selected").text();return new Array(a,b)}else{var d=$("#island option:selected").text();return new Array(c,d)}},getSelectedCategory:function(){var a=$("#category").val();if(a!=""){var b=$("#category option:selected").text();return new Array(a,b)}},validateCategoryForm:function(){var a=$("#category").val();if(a==""){return false}else{return true}},validateAreaForm:function(){var a=$("#island").val();if(a==""){return false}else{return true}},validateTextForm:function(){var a=$("#searchname").val();if(a==""){return false}else{return true}},createMarkersAndList:function(e,b){var d="";var a="";$.each(e,function(g){var f=lamanbudaya.maps.createMarkers(e[g]);a='<li><a class="pointer" onclick="onDestinationClickFromList('+e[g].id+')">'+e[g].name+"</a></li>";d+=a;lamanbudaya.maps.markersArray[e[g].id]=[];lamanbudaya.maps.markersArray[e[g].id].push(f)});var c="<h4>Destination Results "+b+"</h4>";c+="<ul>"+d+"</ul>";$("#listDestination").html(c);$("#listDestination").slideDown("slow")},createMarkers:function(b){var c=new google.maps.LatLng(b.pointY,b.pointX);var a=new google.maps.Marker({position:c,map:lamanbudaya.maps.map,title:b.name,icon:lamanbudaya.maps.iconStandard});a.id=b.id;google.maps.event.addListener(a,"click",function(){lamanbudaya.maps.onMarkerClickEvent(a,b,c)});return a},onMarkerClickEvent:function(a,d,e){lamanbudaya.maps.closeCurrentInfoWindow();var b=lamanbudaya.maps.createContent(d);var c=new google.maps.InfoWindow({content:b,maxWidth:300});c.open(lamanbudaya.maps.map,a);google.maps.event.addListener(c,"closeclick",function(){});lamanbudaya.maps.map.setCenter(e);lamanbudaya.maps.map.setZoom(10);lamanbudaya.maps.currentInfoWindow=c;lamanbudaya.maps.currentMarker=a},createContent:function(d){var c='<div class="infoDialog">';var a="";if(d.image!=""){a='<img class="alignleft" src="'+lamanbudaya.url.imageUrl+"/timthumb.php?src=upload/culture/"+d.image+'&w=150&h=150&q=100" alt="" />'}c+="<h4>"+d.name+"</h4>"+a+"<p>"+d.description+'<span class="read-more"><a class="pointer" onclick="window.open(\''+lamanbudaya.url.baseUrl+"/culture/"+d.id+"')\">"+read_more+" &gt;&gt;</a></span></p>";c+='<div class="clear-left"></div>';c+="<h5>"+categoryText+"</h5>";var b=d.category;$.each(b,function(e){c+="- "+b[e].name+"<br />"});c+="</div>";return c},onIslandChange:function(){lamanbudaya.maps.disableIslandSelect(true);var b=$("#island").val();var a=$("#subarea");if(b==""){a.html("")}else{a.html('<img src="'+lamanbudaya.url.imageUrl+'/loader/fb.gif" />');$.ajax({type:"POST",url:lamanbudaya.url.baseUrl+"/ajax/island",data:{areaId:b},success:function(c){a.html(c);lamanbudaya.maps.disableIslandSelect(false)}})}},disableIslandSelect:function(a){$("#island").attr("disabled",a);$("#submitArea").attr("disabled",a)},reset:function(){lamanbudaya.maps.closeCurrentInfoWindow();lamanbudaya.maps.removeMarkers(lamanbudaya.maps.markersArray);lamanbudaya.maps.showFullMap()},removeMarkers:function(a){for(i in a){for(j in a[i]){a[i][j].setMap(null)}delete a[i]}delete a},closeCurrentInfoWindow:function(){if(lamanbudaya.maps.currentInfoWindow){lamanbudaya.maps.currentInfoWindow.close()}},clearAreaForm:function(){$("#island").val("");$("#province").empty()},clearTextForm:function(){$("#searchname").val("")},clearCategoryForm:function(){$("#category").val("")},createFullMapControl:function(){var a=document.createElement("DIV");var b=new FullMapControl(a);a.index=1;lamanbudaya.maps.map.controls[google.maps.ControlPosition.TOP_RIGHT].push(a)},showFullMap:function(){lamanbudaya.maps.map.setZoom(4);lamanbudaya.maps.map.setCenter(lamanbudaya.maps.indonesiaLatlng)}};function FullMapControl(a){a.style.padding="5px";var c=document.createElement("DIV");c.style.backgroundColor="white";c.style.borderStyle="solid";c.style.borderWidth="2px";c.style.cursor="pointer";c.style.textAlign="center";c.title="Klik untuk melihat peta indonesia secara menyeluruh";a.appendChild(c);var b=document.createElement("DIV");b.style.fontFamily="Arial,sans-serif";b.style.fontSize="12px";b.style.paddingTop="3px";b.style.paddingRight="4px";b.style.paddingBottom="3px";b.style.paddingLeft="4px";b.innerHTML="Peta Indonesia";c.appendChild(b);google.maps.event.addDomListener(c,"click",function(){lamanbudaya.maps.showFullMap()})};